#!/bin/bash

# Set Target IP
IP=10.0.0.1

# Identify if WebDAV is vulnerable
output=$(echo "Checking if WebDAV is vulnerable..." >&2; echo 42)
nmap -sV --script=http-iis-webdav-vuln -oN iis-enumeration.txt $IP

# Check IIS short file names - https://adrianjnkns.medium.com/iis-shortname-vulnerability-67f933849943
output=$(echo "Checking IIS short file names..." >&2; echo 42)
nmap -sV --script=http-iis-short-name-brute -oN iis-enumeration.txt $IP

# Check if WebDAV anonymous access is allowed
output=$(echo "Checking if WebDAV anonymous access is allowed..." >&2; echo 42)
nmap -sV --script=http-iis-webdav-scan -oN iis-enumeration.txt $IP

# Check recursive directory listing
output=$(echo "Checking recursive directory listing..." >&2; echo 42)
nmap -sV --script=http-iis-webdav-enum -oN iis-enumeration.txt $IP

# Check NTLM authentication related information
output=$(echo "Checking NTLM authentication related information..." >&2; echo 42)
nmap -sV --script=http-iis-ntlm-info -oN iis-enumeration.txt $IP

# Receiving directory listing from the WebDAV service
output=$(echo "Receiving directory listing..." >&2; echo 42)
nmap -sV --script=http-iis-webdav-ls -oN iis-enumeration.txt $IP
